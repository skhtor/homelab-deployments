apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

helmCharts:
- name: cert-manager
  releaseName: cert-manager
  namespace: security
  version: 1.19.1
  repo: https://charts.jetstack.io
  valuesInline:
    global:
      leaderElection:
        namespace: security
    installCRDs: true
    extraEnv:
      - name: AWS_EC2_METADATA_SERVICE_ENDPOINT
        value: http://aws-signing-helper.security.svc.cluster.local:9911
      - name: AWS_REGION
        value: ap-southeast-2

resources:
  - ./resources/aws-signing-helper.yaml
  - ./resources/cluster-issuer.yaml
  - ./resources/iamra-cert.yaml
  - ./resources/root-ca.yaml
